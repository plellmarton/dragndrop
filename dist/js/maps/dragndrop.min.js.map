{"version":3,"sources":["dragndrop.js"],"names":["DragNDrop","Container","options","this","Repository","DropZone","data","PlaceHolder","init","prototype","repository","dropzone","update","querySelectorAll","document","createElement","className","events","renderItem","index","template","variables","{{index}}","{{img.id}}","id","{{img.src}}","url","{{img.name}}","name","replace","matched","output","render","innerHTML","addEventListener","dragStartHandler","bind","dragHandler","dragEndHandler","dropHandler","dragOverHandler","e","item","target","moveFrom","path","getAttribute","dataIndex","parseInt","crt","cloneNode","style","display","visibility","body","appendChild","dataTransfer","setDragImage","setData","JSON","stringify","width","offsetWidth","height","offsetHeight","position","top","clientY","left","clientX","transform","zIndex","pointerEvents","preventDefault","getData","parse","itemIndex","undefined","push","splice","console","log","{{repository.items}}","map","toString","{{dropzone.items}}"],"mappings":"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","file":"../dragndrop.min.js","sourcesContent":["function DragNDrop (Container, options) {\n  this.Container = null\n  this.Repository = []\n  this.DropZone = []\n  this.data = {}\n  this.PlaceHolder = ''\n  this.init(Container, options)\n}\n\nDragNDrop.prototype = {\n  init: function (Container, options) {\n    this.Container = Container\n    this.data = {\n      repository: options.repository,\n      dropzone: []\n    }\n    this.update()\n    this.Repository = this.Container.querySelectorAll('[data-ref=\"repository\"]')[0]\n    this.DropZone = this.Container.querySelectorAll('[data-ref=\"dropzone\"]')[0]\n    var PlaceHolder = document.createElement('div')\n    PlaceHolder.className = 'dragndrop__placeholder'\n    this.PlaceHolder = PlaceHolder\n    this.events()\n  },\n\n  renderItem: function (data, index) {\n    var template = '<div class=\"dragndrop__item\" draggable=\"true\" data-ref=\"item\" data-id=\"{{img.id}}\" data-index=\"{{index}}\">' +\n      '<img src=\"{{img.src}}\" alt=\"{{img.name}}\" draggable=\"false\">' +\n      '<span class=\"dragndrop__item-name\" draggable=\"false\">{{img.name}}</span>' +\n      '</div>'\n\n    var variables = {\n      '{{index}}': index,\n      '{{img.id}}': data.id,\n      '{{img.src}}': data.url,\n      '{{img.name}}': data.name\n    }\n\n    template = template.replace(/{{img.src}}|{{img.name}}|{{img.id}}|{{index}}/gi, function (matched) {\n      return variables[matched]\n    })\n\n    return template\n  },\n\n  update: function () {\n    var output = this.render()\n    this.Container.innerHTML = output\n  },\n\n  events: function () {\n    this.Container.addEventListener('dragstart', this.dragStartHandler.bind(this))\n    this.Container.addEventListener('drag', this.dragHandler)\n    this.Container.addEventListener('dragend', this.dragEndHandler.bind(this))\n    this.Container.addEventListener('drop', this.dropHandler.bind(this))\n    this.Container.addEventListener('dragover', this.dragOverHandler)\n  },\n\n  dragStartHandler: function (e) {\n    var item = e.target\n    var moveFrom = e.path[1].getAttribute('data-ref')\n    var dataIndex = parseInt(item.getAttribute('data-index'))\n\n    var crt = e.target.cloneNode(true)\n    crt.style.display = 'none'\n    crt.style.visibility = 'hidden'\n    document.body.appendChild(crt)\n    e.dataTransfer.setDragImage(crt, 0, 0)\n\n    e.dataTransfer.setData('moveFrom', moveFrom)\n    e.dataTransfer.setData('item', JSON.stringify(this.data[moveFrom][dataIndex]))\n    e.dataTransfer.setData('itemIndex', dataIndex)\n  },\n\n  dragHandler: function (e) {\n    var item = e.target\n    var width = item.offsetWidth\n    var height = item.offsetHeight\n\n    item.style.width = width + 'px'\n    item.style.position = 'absolute'\n    item.style.top = e.clientY - (height / 2) + 'px'\n    item.style.left = e.clientX - (width / 2) + 'px'\n    item.style.transform = 'rotate(5deg)'\n    item.style.zIndex = 1000\n    item.style.pointerEvents = 'none'\n  },\n\n  dragOverHandler: function (e) {\n    var target = e.target.getAttribute('data-ref')\n    if (target === 'dropzone') {\n      e.preventDefault()\n    } else if (target === 'repository') {\n      e.preventDefault()\n    }\n  },\n\n  dragEndHandler: function (e) {\n    var item = e.target\n    var moveFrom = e.path[1].getAttribute('data-ref')\n    var dataIndex = parseInt(item.getAttribute('data-index'))\n\n    item.style.width = ''\n    item.style.position = ''\n    item.style.top = ''\n    item.style.left = ''\n    item.style.transform = 'rotate(0)'\n    item.style.zIndex = ''\n    item.style.pointerEvents = ''\n\n    e.dataTransfer.setData('moveFrom', moveFrom)\n    e.dataTransfer.setData('item', JSON.stringify(this.data[moveFrom][dataIndex]))\n    e.dataTransfer.setData('itemIndex', dataIndex)\n  },\n\n  dropHandler: function (e) {\n    var moveFrom = e.dataTransfer.getData('moveFrom')\n    var item = JSON.parse(e.dataTransfer.getData('item'))\n    var itemIndex = e.dataTransfer.getData('itemIndex')\n    var target = e.target.getAttribute('data-ref')\n    var insertBeforeIndex = e.dataTransfer.getData('insertBeforeIndex')\n\n    if (moveFrom !== target) {\n      var data = this.data\n      if (data[target] === undefined) {\n        data[target] = []\n      }\n      data[target].push(item)\n      data[moveFrom].splice(parseInt(itemIndex), 1)\n      this.data = data\n    }\n    console.log(e)\n    this.update()\n  },\n\n  render: function () {\n    var template = '<div class=\"dragndrop__repository\" data-ref=\"repository\">{{repository.items}}</div>' +\n      '<div class=\"dragndrop__dropzone\" data-ref=\"dropzone\">{{dropzone.items}}</div>'\n\n    var variables = {\n      '{{repository.items}}': this.data.repository.map(function (item, index) {\n        return this.renderItem(item, index)\n      }.bind(this)).toString().replace(/,/gi, ''),\n      '{{dropzone.items}}': this.data.dropzone !== undefined ? this.data.dropzone.map(function (item, index) {\n        return this.renderItem(item, index)\n      }.bind(this)).toString().replace(/,/gi, '') : ''\n    }\n\n    template = template.replace(/{{repository.items}}|{{dropzone.items}}/gi, function (matched) {\n      return variables[matched]\n    })\n\n    return template\n  }\n}\n"]}