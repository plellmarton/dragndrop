{"version":3,"sources":["dragndrop.js"],"names":["DragNDrop","Container","options","this","Repository","DropZone","data","PlaceHolder","init","prototype","repository","dropzone","update","querySelectorAll","document","createElement","className","events","renderItem","index","template","variables","{{index}}","{{index1}}","{{img.id}}","id","{{img.src}}","url","{{img.name}}","name","replace","matched","output","render","innerHTML","addEventListener","dragStartHandler","bind","dragHandler","dragEndHandler","dropHandler","dragOverHandler","e","item","target","moveFrom","path","getAttribute","dataIndex","parseInt","crt","cloneNode","style","display","visibility","body","appendChild","dataTransfer","setDragImage","setData","JSON","stringify","width","offsetWidth","height","offsetHeight","position","top","clientY","left","clientX","transform","zIndex","pointerEvents","forEach","element","classList","remove","preventDefault","add","getData","parse","itemIndex","isInsertBefore","beforeItem","beforeIndex","splice","undefined","push","{{repository.items}}","map","toString","{{dropzone.items}}"],"mappings":"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","file":"../dragndrop.min.js","sourcesContent":["function DragNDrop(Container, options) {\n  this.Container = null\n  this.Repository = []\n  this.DropZone = []\n  this.data = {}\n  this.PlaceHolder = ''\n  this.init(Container, options)\n}\n\nDragNDrop.prototype = {\n  init: function (Container, options) {\n    this.Container = Container\n    this.data = {\n      repository: options.repository,\n      dropzone: []\n    }\n    this.update()\n    this.Repository = this.Container.querySelectorAll('[data-ref=\"repository\"]')[0]\n    this.DropZone = this.Container.querySelectorAll('[data-ref=\"dropzone\"]')[0]\n    var PlaceHolder = document.createElement('div')\n    PlaceHolder.className = 'dragndrop__placeholder'\n    this.PlaceHolder = PlaceHolder\n    this.events()\n  },\n\n  renderItem: function (data, index) {\n    var template = '<div class=\"dragndrop__item\" draggable=\"true\" data-ref=\"item\" data-id=\"{{img.id}}\" data-index=\"{{index}}\">' +\n      '<img src=\"{{img.src}}\" alt=\"{{img.name}}\" draggable=\"false\">' +\n      '<span class=\"dragndrop__item-name\" draggable=\"false\">{{img.name}}</span>' +\n      '<i class=\"dragndrop__item-index\">{{index1}}</i>' +\n      '</div>'\n\n    var variables = {\n      '{{index}}': index,\n      '{{index1}}': index + 1,\n      '{{img.id}}': data.id,\n      '{{img.src}}': data.url,\n      '{{img.name}}': data.name\n    }\n\n    template = template.replace(/{{img.src}}|{{img.name}}|{{img.id}}|{{index}}|{{index1}}/gi, function (matched) {\n      return variables[matched]\n    })\n\n    return template\n  },\n\n  update: function () {\n    var output = this.render()\n    this.Container.innerHTML = output\n  },\n\n  events: function () {\n    this.Container.addEventListener('dragstart', this.dragStartHandler.bind(this))\n    this.Container.addEventListener('drag', this.dragHandler)\n    this.Container.addEventListener('dragend', this.dragEndHandler.bind(this))\n    this.Container.addEventListener('drop', this.dropHandler.bind(this))\n    this.Container.addEventListener('dragover', this.dragOverHandler.bind(this))\n  },\n\n  dragStartHandler: function (e) {\n    var item = e.target\n    var moveFrom = e.path[1].getAttribute('data-ref')\n    var dataIndex = parseInt(item.getAttribute('data-index'))\n\n    var crt = e.target.cloneNode(true)\n    crt.style.display = 'none'\n    crt.style.visibility = 'hidden'\n    document.body.appendChild(crt)\n    e.dataTransfer.setDragImage(crt, 0, 0)\n\n    e.dataTransfer.setData('moveFrom', moveFrom)\n    e.dataTransfer.setData('item', JSON.stringify(this.data[moveFrom][dataIndex]))\n    e.dataTransfer.setData('itemIndex', dataIndex)\n  },\n\n  dragHandler: function (e) {\n    var item = e.target\n    var width = item.offsetWidth\n    var height = item.offsetHeight\n\n    item.style.width = width + 'px'\n    item.style.position = 'absolute'\n    item.style.top = e.clientY - (height / 2) + 'px'\n    item.style.left = e.clientX - (width / 2) + 'px'\n    item.style.transform = 'rotate(5deg)'\n    item.style.zIndex = 1000\n    item.style.pointerEvents = 'none'\n  },\n\n  dragOverHandler: function (e) {\n    var target = e.target.getAttribute('data-ref')\n    var placeholders = this.Container.querySelectorAll('.insert-placeholder')\n    placeholders.forEach(function (element) {\n      element.classList.remove('insert-placeholder')\n    })\n    if (target === 'dropzone') {\n      e.preventDefault()\n    } else if (target === 'repository') {\n      e.preventDefault()\n    } else if (e.path[1].getAttribute('data-ref') === 'item') {\n      e.preventDefault()\n      e.path[1].classList.add('insert-placeholder')\n    }\n  },\n\n  dragEndHandler: function (e) {\n    var item = e.target\n    var moveFrom = e.path[1].getAttribute('data-ref')\n    var dataIndex = parseInt(item.getAttribute('data-index'))\n\n    item.style.width = ''\n    item.style.position = ''\n    item.style.top = ''\n    item.style.left = ''\n    item.style.transform = 'rotate(0)'\n    item.style.zIndex = ''\n    item.style.pointerEvents = ''\n\n    e.dataTransfer.setData('moveFrom', moveFrom)\n    e.dataTransfer.setData('item', JSON.stringify(this.data[moveFrom][dataIndex]))\n    e.dataTransfer.setData('itemIndex', dataIndex)\n  },\n\n  dropHandler: function (e) {\n    var moveFrom = e.dataTransfer.getData('moveFrom')\n    var item = JSON.parse(e.dataTransfer.getData('item'))\n    var itemIndex = e.dataTransfer.getData('itemIndex')\n    var target = e.target.getAttribute('data-ref')\n    var isInsertBefore = false\n    if (target === null) {\n      target = e.path[2].getAttribute('data-ref')\n      var beforeItem = e.path[1]\n      var beforeIndex = parseInt(beforeItem.getAttribute('data-index'))\n      isInsertBefore = true\n    }\n\n    var data = this.data\n\n    data[moveFrom].splice(parseInt(itemIndex), 1)\n    if (data[target] === undefined) {\n      data[target] = []\n    }\n    if (isInsertBefore) {\n      data[target].splice(beforeIndex, 0, item)\n    } else {\n      data[target].push(item)\n    }\n\n    this.data = data\n    this.update()\n  },\n\n  render: function () {\n    var template = '<div class=\"dragndrop__repository\" data-ref=\"repository\">{{repository.items}}</div>' +\n      '<div class=\"dragndrop__dropzone\" data-ref=\"dropzone\">{{dropzone.items}}</div>'\n\n    var variables = {\n      '{{repository.items}}': this.data.repository.map(function (item, index) {\n        return this.renderItem(item, index)\n      }.bind(this)).toString().replace(/,/gi, ''),\n      '{{dropzone.items}}': this.data.dropzone !== undefined ? this.data.dropzone.map(function (item, index) {\n        return this.renderItem(item, index)\n      }.bind(this)).toString().replace(/,/gi, '') : ''\n    }\n\n    template = template.replace(/{{repository.items}}|{{dropzone.items}}/gi, function (matched) {\n      return variables[matched]\n    })\n\n    return template\n  }\n}\n"]}